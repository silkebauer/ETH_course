<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Exercise: Refreshing R and linear models | Handout and background material for ETHZ course ‘Animal Migration and research in field ornithology’</title>
  <meta name="description" content="This is a handout for the ETH migration course at Col de Bretolet." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Exercise: Refreshing R and linear models | Handout and background material for ETHZ course ‘Animal Migration and research in field ornithology’" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a handout for the ETH migration course at Col de Bretolet." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Exercise: Refreshing R and linear models | Handout and background material for ETHZ course ‘Animal Migration and research in field ornithology’" />
  
  <meta name="twitter:description" content="This is a handout for the ETH migration course at Col de Bretolet." />
  

<meta name="author" content="Silke Bauer &amp; Fränzi Korner-Nievergelt" />


<meta name="date" content="2025-07-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="StudentProjects.html"/>
<link rel="next" href="geolocs.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Handout ETH course Migration ecology and methods in field ornithology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General information</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#course-aims"><i class="fa fa-check"></i><b>2.1</b> Course aims</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#course-schedule"><i class="fa fa-check"></i><b>2.2</b> Course schedule</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="12-RefreshingRLinMod.html"><a href="#prepatory-days-2-5-september-2025-at-swiss-ornithological-institute-sempach-and-eth-z%C3%BCrich"><i class="fa fa-check"></i><b>2.2.1</b> Prepatory days: 2-5 September 2025 at Swiss Ornithological Institute Sempach and ETH Zürich</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction.html"><a href="introduction.html#course-day-1-tuesday-2-september-2025-in-sempach"><i class="fa fa-check"></i><b>2.2.2</b> Course day 1: Tuesday, 2 September 2025 in Sempach</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction.html"><a href="introduction.html#course-day-2-wednesday-3-september-2025"><i class="fa fa-check"></i><b>2.2.3</b> Course day 2: Wednesday, 3 September 2025</a></li>
<li class="chapter" data-level="2.2.4" data-path="introduction.html"><a href="introduction.html#course-day-3-thursday-4-september-2025"><i class="fa fa-check"></i><b>2.2.4</b> Course day 3: Thursday, 4 September 2025</a></li>
<li class="chapter" data-level="2.2.5" data-path="introduction.html"><a href="introduction.html#course-day-4-friday-5-september-2025"><i class="fa fa-check"></i><b>2.2.5</b> Course day 4: Friday, 5 September 2025</a></li>
<li class="chapter" data-level="2.2.6" data-path="introduction.html"><a href="introduction.html#excursion-to-col-de-bretolet-mon-fri-8-12-september-2025"><i class="fa fa-check"></i><b>2.2.6</b> Excursion to Col de Bretolet: Mon-Fri 8-12 September 2025</a></li>
<li class="chapter" data-level="2.2.7" data-path="introduction.html"><a href="introduction.html#course-day-5-monday-8-september-2024"><i class="fa fa-check"></i><b>2.2.7</b> Course day 5: Monday, 8 September 2024</a></li>
<li class="chapter" data-level="2.2.8" data-path="introduction.html"><a href="introduction.html#course-day-6-tuesday-9-september-2025"><i class="fa fa-check"></i><b>2.2.8</b> Course day 6: Tuesday, 9 September 2025</a></li>
<li class="chapter" data-level="2.2.9" data-path="introduction.html"><a href="introduction.html#course-day-6-wednesday-10-september-2025"><i class="fa fa-check"></i><b>2.2.9</b> Course day 6: Wednesday, 10 September 2025</a></li>
<li class="chapter" data-level="2.2.10" data-path="introduction.html"><a href="introduction.html#course-day-7-thursday-11-september-2025"><i class="fa fa-check"></i><b>2.2.10</b> Course day 7: Thursday, 11 September 2025</a></li>
<li class="chapter" data-level="2.2.11" data-path="introduction.html"><a href="introduction.html#course-day-8-friday-12-september-2025"><i class="fa fa-check"></i><b>2.2.11</b> Course day 8: Friday, 12 September 2025</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#preparations"><i class="fa fa-check"></i><b>2.3</b> Preparations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="animal-migration.html"><a href="animal-migration.html"><i class="fa fa-check"></i><b>3</b> Animal migration</a>
<ul>
<li class="chapter" data-level="3.1" data-path="animal-migration.html"><a href="animal-migration.html#what-is-migration"><i class="fa fa-check"></i><b>3.1</b> What is migration?</a></li>
<li class="chapter" data-level="3.2" data-path="animal-migration.html"><a href="animal-migration.html#why-do-birds-migrate"><i class="fa fa-check"></i><b>3.2</b> Why do birds migrate?</a></li>
<li class="chapter" data-level="3.3" data-path="animal-migration.html"><a href="animal-migration.html#terminology-of-specific-migration-patterns"><i class="fa fa-check"></i><b>3.3</b> Terminology of specific migration patterns</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="animal-migration.html"><a href="animal-migration.html#characterisation-of-migration-according-to-distances-covered"><i class="fa fa-check"></i><b>3.3.1</b> Characterisation of migration according to distances covered</a></li>
<li class="chapter" data-level="3.3.2" data-path="animal-migration.html"><a href="animal-migration.html#characterisation-of-migration-according-to-daytime-of-travel"><i class="fa fa-check"></i><b>3.3.2</b> Characterisation of migration according to daytime of travel</a></li>
<li class="chapter" data-level="3.3.3" data-path="animal-migration.html"><a href="animal-migration.html#characterisation-of-migration-according-to-larger-scale-patterns-of-migratory-bouts"><i class="fa fa-check"></i><b>3.3.3</b> Characterisation of migration according to larger-scale patterns of migratory bouts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="timing-of-migration.html"><a href="timing-of-migration.html"><i class="fa fa-check"></i><b>4</b> Timing of migration</a>
<ul>
<li class="chapter" data-level="4.1" data-path="timing-of-migration.html"><a href="timing-of-migration.html#why-is-timing-important"><i class="fa fa-check"></i><b>4.1</b> Why is timing important?</a></li>
<li class="chapter" data-level="4.2" data-path="timing-of-migration.html"><a href="timing-of-migration.html#what-determines-the-timing-of-migratory-steps-cues"><i class="fa fa-check"></i><b>4.2</b> What determines the timing of migratory steps? Cues!</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="timing-of-migration.html"><a href="timing-of-migration.html#preparation"><i class="fa fa-check"></i><b>4.2.1</b> Preparation</a></li>
<li class="chapter" data-level="4.2.2" data-path="timing-of-migration.html"><a href="timing-of-migration.html#departure"><i class="fa fa-check"></i><b>4.2.2</b> Departure</a></li>
<li class="chapter" data-level="4.2.3" data-path="timing-of-migration.html"><a href="timing-of-migration.html#on-the-way"><i class="fa fa-check"></i><b>4.2.3</b> On the way</a></li>
<li class="chapter" data-level="4.2.4" data-path="timing-of-migration.html"><a href="timing-of-migration.html#termination"><i class="fa fa-check"></i><b>4.2.4</b> Termination</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="timing-of-migration.html"><a href="timing-of-migration.html#consequences-of-migration-timing"><i class="fa fa-check"></i><b>4.3</b> Consequences of migration timing</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="orientation-and-navigation.html"><a href="orientation-and-navigation.html"><i class="fa fa-check"></i><b>5</b> Orientation and Navigation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="orientation-and-navigation.html"><a href="orientation-and-navigation.html#sun-compass"><i class="fa fa-check"></i><b>5.1</b> Sun compass</a></li>
<li class="chapter" data-level="5.2" data-path="orientation-and-navigation.html"><a href="orientation-and-navigation.html#star-compass"><i class="fa fa-check"></i><b>5.2</b> Star compass</a></li>
<li class="chapter" data-level="5.3" data-path="orientation-and-navigation.html"><a href="orientation-and-navigation.html#magnetic-compass"><i class="fa fa-check"></i><b>5.3</b> Magnetic compass</a></li>
<li class="chapter" data-level="5.4" data-path="orientation-and-navigation.html"><a href="orientation-and-navigation.html#landmarks"><i class="fa fa-check"></i><b>5.4</b> Landmarks</a></li>
<li class="chapter" data-level="5.5" data-path="orientation-and-navigation.html"><a href="orientation-and-navigation.html#olfactory-cues"><i class="fa fa-check"></i><b>5.5</b> Olfactory cues</a></li>
<li class="chapter" data-level="5.6" data-path="orientation-and-navigation.html"><a href="orientation-and-navigation.html#compass-orientation-vs.-navigation"><i class="fa fa-check"></i><b>5.6</b> Compass orientation vs. navigation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="flight-energetics-and-plasticity-of-the-migratory-flight.html"><a href="flight-energetics-and-plasticity-of-the-migratory-flight.html"><i class="fa fa-check"></i><b>6</b> Flight energetics and plasticity of the migratory flight</a>
<ul>
<li class="chapter" data-level="6.1" data-path="flight-energetics-and-plasticity-of-the-migratory-flight.html"><a href="flight-energetics-and-plasticity-of-the-migratory-flight.html#mechanics-and-energetics-of-flight"><i class="fa fa-check"></i><b>6.1</b> Mechanics and energetics of flight</a></li>
<li class="chapter" data-level="6.2" data-path="flight-energetics-and-plasticity-of-the-migratory-flight.html"><a href="flight-energetics-and-plasticity-of-the-migratory-flight.html#fuel-for-migratory-flights"><i class="fa fa-check"></i><b>6.2</b> Fuel for migratory flights</a></li>
<li class="chapter" data-level="6.3" data-path="flight-energetics-and-plasticity-of-the-migratory-flight.html"><a href="flight-energetics-and-plasticity-of-the-migratory-flight.html#influences-on-migration"><i class="fa fa-check"></i><b>6.3</b> Influences on migration</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="flight-energetics-and-plasticity-of-the-migratory-flight.html"><a href="flight-energetics-and-plasticity-of-the-migratory-flight.html#endogeneous-and-exogeneous-factors"><i class="fa fa-check"></i><b>6.3.1</b> Endogeneous and exogeneous factors</a></li>
<li class="chapter" data-level="6.3.2" data-path="flight-energetics-and-plasticity-of-the-migratory-flight.html"><a href="flight-energetics-and-plasticity-of-the-migratory-flight.html#topography"><i class="fa fa-check"></i><b>6.3.2</b> Topography</a></li>
<li class="chapter" data-level="6.3.3" data-path="flight-energetics-and-plasticity-of-the-migratory-flight.html"><a href="flight-energetics-and-plasticity-of-the-migratory-flight.html#wind"><i class="fa fa-check"></i><b>6.3.3</b> Wind</a></li>
<li class="chapter" data-level="6.3.4" data-path="flight-energetics-and-plasticity-of-the-migratory-flight.html"><a href="flight-energetics-and-plasticity-of-the-migratory-flight.html#temperature"><i class="fa fa-check"></i><b>6.3.4</b> Temperature</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="importance-of-migration-for-the-structure-and-dynamics-of-resident-communities.html"><a href="importance-of-migration-for-the-structure-and-dynamics-of-resident-communities.html"><i class="fa fa-check"></i><b>7</b> Importance of migration for the structure and dynamics of resident communities</a>
<ul>
<li class="chapter" data-level="7.1" data-path="importance-of-migration-for-the-structure-and-dynamics-of-resident-communities.html"><a href="importance-of-migration-for-the-structure-and-dynamics-of-resident-communities.html#migrants-link-ecological-communities-and-ecosystem-functioning-worldwide"><i class="fa fa-check"></i><b>7.1</b> Migrants link ecological communities and ecosystem functioning worldwide</a></li>
<li class="chapter" data-level="7.2" data-path="importance-of-migration-for-the-structure-and-dynamics-of-resident-communities.html"><a href="importance-of-migration-for-the-structure-and-dynamics-of-resident-communities.html#animal-migrations-provide-services-and-disservices"><i class="fa fa-check"></i><b>7.2</b> Animal migrations provide services and disservices</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="global-change-and-other-challenges.html"><a href="global-change-and-other-challenges.html"><i class="fa fa-check"></i><b>8</b> Global change and other challenges</a>
<ul>
<li class="chapter" data-level="8.1" data-path="global-change-and-other-challenges.html"><a href="global-change-and-other-challenges.html#climate-change"><i class="fa fa-check"></i><b>8.1</b> Climate change</a></li>
<li class="chapter" data-level="8.2" data-path="global-change-and-other-challenges.html"><a href="global-change-and-other-challenges.html#sensory-pollution"><i class="fa fa-check"></i><b>8.2</b> Sensory pollution</a></li>
<li class="chapter" data-level="8.3" data-path="global-change-and-other-challenges.html"><a href="global-change-and-other-challenges.html#man-made-structures"><i class="fa fa-check"></i><b>8.3</b> Man-made structures</a></li>
<li class="chapter" data-level="8.4" data-path="global-change-and-other-challenges.html"><a href="global-change-and-other-challenges.html#conservation-of-migrants-and-migrations"><i class="fa fa-check"></i><b>8.4</b> Conservation of migrants and migrations</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="field-methods.html"><a href="field-methods.html"><i class="fa fa-check"></i><b>9</b> Field methods</a>
<ul>
<li class="chapter" data-level="9.1" data-path="field-methods.html"><a href="field-methods.html#observations-visual-moonwatching-ir-radar"><i class="fa fa-check"></i><b>9.1</b> Observations: visual, moonwatching, IR, radar</a></li>
<li class="chapter" data-level="9.2" data-path="field-methods.html"><a href="field-methods.html#marking-and-reencountering"><i class="fa fa-check"></i><b>9.2</b> Marking and reencountering</a></li>
<li class="chapter" data-level="9.3" data-path="field-methods.html"><a href="field-methods.html#tracking-individuals"><i class="fa fa-check"></i><b>9.3</b> Tracking individuals</a></li>
<li class="chapter" data-level="9.4" data-path="field-methods.html"><a href="field-methods.html#orientation-experiments"><i class="fa fa-check"></i><b>9.4</b> Orientation experiments</a></li>
<li class="chapter" data-level="9.5" data-path="field-methods.html"><a href="field-methods.html#stable-isotopes-genetics-and-physiology"><i class="fa fa-check"></i><b>9.5</b> Stable isotopes, genetics and physiology</a></li>
<li class="chapter" data-level="9.6" data-path="field-methods.html"><a href="field-methods.html#references"><i class="fa fa-check"></i><b>9.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="migration-models.html"><a href="migration-models.html"><i class="fa fa-check"></i><b>10</b> Migration models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="migration-models.html"><a href="migration-models.html#state-dependent-migration-models"><i class="fa fa-check"></i><b>10.1</b> State-dependent migration models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="statistical-tools-for-studying-migration.html"><a href="statistical-tools-for-studying-migration.html"><i class="fa fa-check"></i><b>11</b> Statistical tools for studying migration</a>
<ul>
<li class="chapter" data-level="11.1" data-path="statistical-tools-for-studying-migration.html"><a href="statistical-tools-for-studying-migration.html#linear-models"><i class="fa fa-check"></i><b>11.1</b> Linear models</a></li>
<li class="chapter" data-level="11.2" data-path="statistical-tools-for-studying-migration.html"><a href="statistical-tools-for-studying-migration.html#distribution-models-for-counts-of-resting-or-migrating-individuals"><i class="fa fa-check"></i><b>11.2</b> Distribution models for counts of resting or migrating individuals</a></li>
<li class="chapter" data-level="11.3" data-path="statistical-tools-for-studying-migration.html"><a href="statistical-tools-for-studying-migration.html#migratory-connectivity-models"><i class="fa fa-check"></i><b>11.3</b> Migratory connectivity models</a></li>
<li class="chapter" data-level="11.4" data-path="statistical-tools-for-studying-migration.html"><a href="statistical-tools-for-studying-migration.html#estimating-survival-based-on-mark-recapture-data-the-cormack-jolly-seber-model"><i class="fa fa-check"></i><b>11.4</b> Estimating survival based on mark-recapture data: The Cormack-Jolly-Seber model</a></li>
<li class="chapter" data-level="11.5" data-path="statistical-tools-for-studying-migration.html"><a href="statistical-tools-for-studying-migration.html#multi-state-models-to-estimate-movement-rates"><i class="fa fa-check"></i><b>11.5</b> Multi-state models to estimate movement rates</a></li>
<li class="chapter" data-level="11.6" data-path="statistical-tools-for-studying-migration.html"><a href="statistical-tools-for-studying-migration.html#individual-based-hidden-markov-model-for-bird-behaviour"><i class="fa fa-check"></i><b>11.6</b> Individual based hidden Markov model for bird behaviour</a></li>
<li class="chapter" data-level="11.7" data-path="statistical-tools-for-studying-migration.html"><a href="statistical-tools-for-studying-migration.html#the-combination-of-different-data-sources"><i class="fa fa-check"></i><b>11.7</b> The combination of different data sources</a></li>
<li class="chapter" data-level="11.8" data-path="statistical-tools-for-studying-migration.html"><a href="statistical-tools-for-studying-migration.html#references-1"><i class="fa fa-check"></i><b>11.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="StudentProjects.html"><a href="StudentProjects.html"><i class="fa fa-check"></i><b>12</b> Student projects</a>
<ul>
<li class="chapter" data-level="12.1" data-path="StudentProjects.html"><a href="StudentProjects.html#pre-requisite-reading-and-assessing-scientific-publications"><i class="fa fa-check"></i><b>12.1</b> Pre-requisite: Reading and assessing scientific publications</a></li>
<li class="chapter" data-level="12.2" data-path="StudentProjects.html"><a href="StudentProjects.html#student-project-1-phenology---migration-timing-within-the-season-and-their-changes-over-the-years"><i class="fa fa-check"></i><b>12.2</b> Student project 1: Phenology - Migration timing within the season and their changes over the years</a></li>
<li class="chapter" data-level="12.3" data-path="StudentProjects.html"><a href="StudentProjects.html#student-project-2-long-term-changes-in-morphology"><i class="fa fa-check"></i><b>12.3</b> Student project 2: Long-term changes in morphology</a></li>
<li class="chapter" data-level="12.4" data-path="StudentProjects.html"><a href="StudentProjects.html#student-project-3-differential-migration"><i class="fa fa-check"></i><b>12.4</b> Student project 3: Differential Migration</a></li>
<li class="chapter" data-level="12.5" data-path="StudentProjects.html"><a href="StudentProjects.html#student-project-4-flight-energetics-in-the-course-of-a-night-and-over-the-season"><i class="fa fa-check"></i><b>12.5</b> Student project 4: Flight energetics in the course of a night and over the season</a></li>
<li class="chapter" data-level="12.6" data-path="StudentProjects.html"><a href="StudentProjects.html#student-project-5-estimate-survival-from-capture-recapture-data"><i class="fa fa-check"></i><b>12.6</b> Student project 5: Estimate survival from capture-recapture data</a></li>
<li class="chapter" data-level="12.7" data-path="StudentProjects.html"><a href="StudentProjects.html#student-project-6-modelling-spring-migration-several-questions"><i class="fa fa-check"></i><b>12.7</b> Student project 6: Modelling spring migration: several questions</a></li>
<li class="chapter" data-level="12.8" data-path="StudentProjects.html"><a href="StudentProjects.html#student-project-7-estimating-migration-volume"><i class="fa fa-check"></i><b>12.8</b> Student project 7: Estimating Migration volume</a></li>
<li class="chapter" data-level="12.9" data-path="StudentProjects.html"><a href="StudentProjects.html#student-project-8-why-is-timing-in-spring-important"><i class="fa fa-check"></i><b>12.9</b> Student project 8: Why is timing in spring important?</a></li>
<li class="chapter" data-level="12.10" data-path="StudentProjects.html"><a href="StudentProjects.html#student-project-9-geolocation---tracking-small-birds"><i class="fa fa-check"></i><b>12.10</b> Student project 9: Geolocation - tracking small birds</a></li>
<li class="chapter" data-level="12.11" data-path="StudentProjects.html"><a href="StudentProjects.html#references-2"><i class="fa fa-check"></i><b>12.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="refresher.html"><a href="refresher.html"><i class="fa fa-check"></i><b>13</b> Exercise: Refreshing R and linear models</a>
<ul>
<li class="chapter" data-level="13.1" data-path="refresher.html"><a href="refresher.html#refreshing-r"><i class="fa fa-check"></i><b>13.1</b> Refreshing R</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="refresher.html"><a href="refresher.html#software-installation"><i class="fa fa-check"></i><b>13.1.1</b> Software installation</a></li>
<li class="chapter" data-level="13.1.2" data-path="refresher.html"><a href="refresher.html#working-with-r"><i class="fa fa-check"></i><b>13.1.2</b> Working with R</a></li>
<li class="chapter" data-level="13.1.3" data-path="refresher.html"><a href="refresher.html#working-with-rmarkdown"><i class="fa fa-check"></i><b>13.1.3</b> Working with rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="refresher.html"><a href="refresher.html#linear-regression"><i class="fa fa-check"></i><b>13.2</b> Linear regression</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="refresher.html"><a href="refresher.html#theory"><i class="fa fa-check"></i><b>13.2.1</b> Theory</a></li>
<li class="chapter" data-level="13.2.2" data-path="refresher.html"><a href="refresher.html#fitting-a-linear-regression-in-r"><i class="fa fa-check"></i><b>13.2.2</b> Fitting a Linear Regression in R</a></li>
<li class="chapter" data-level="13.2.3" data-path="refresher.html"><a href="refresher.html#data"><i class="fa fa-check"></i><b>13.2.3</b> Data</a></li>
<li class="chapter" data-level="13.2.4" data-path="refresher.html"><a href="refresher.html#fit-the-regression-using-lm"><i class="fa fa-check"></i><b>13.2.4</b> Fit the regression using lm</a></li>
<li class="chapter" data-level="13.2.5" data-path="refresher.html"><a href="refresher.html#check-the-model-assumptions"><i class="fa fa-check"></i><b>13.2.5</b> Check the model assumptions</a></li>
<li class="chapter" data-level="13.2.6" data-path="refresher.html"><a href="refresher.html#drawing-conclusions"><i class="fa fa-check"></i><b>13.2.6</b> Drawing Conclusions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="geolocs.html"><a href="geolocs.html"><i class="fa fa-check"></i><b>14</b> Exercise: Geolocation</a></li>
<li class="chapter" data-level="15" data-path="migcon.html"><a href="migcon.html"><i class="fa fa-check"></i><b>15</b> Exercise: Estimating migratory connectivity</a>
<ul>
<li class="chapter" data-level="15.1" data-path="migcon.html"><a href="migcon.html#background"><i class="fa fa-check"></i><b>15.1</b> Background</a></li>
<li class="chapter" data-level="15.2" data-path="migcon.html"><a href="migcon.html#nightingale-example"><i class="fa fa-check"></i><b>15.2</b> Nightingale example</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/silkebauer/ETH_course" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Handout and background material for ETHZ course ‘Animal Migration and research in field ornithology’</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="refresher" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Exercise: Refreshing R and linear models<a href="refresher.html#refresher" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="refreshing-r" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Refreshing R<a href="refresher.html#refreshing-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="software-installation" class="section level3 hasAnchor" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Software installation<a href="refresher.html#software-installation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Download R and RStudio.</p>
<p>Install the packages <code>rmarkdown</code>, <code>bookdown</code>, <code>knitr</code>, <code>dplyr</code>, <code>tidyr</code>, <code>ggplot2</code>and <code>arm</code> by typing <code>install.packages("rmarkdown")</code> etc. in the R-console. R-packages need to be installed only once, or after a major update of R.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="refresher.html#cb11-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;rmarkdown&quot;</span>, <span class="st">&quot;bookdown&quot;</span>, <span class="st">&quot;knitr&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;tidyr&quot;</span>, <span class="st">&quot;ggplot2&quot;</span>,  <span class="st">&quot;arm&quot;</span>, <span class="st">&quot;bookdown&quot;</span>))</span></code></pre></div>
</div>
<div id="working-with-r" class="section level3 hasAnchor" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> Working with R<a href="refresher.html#working-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Writing and editing code is done in a text editor such as Wordpad or RStudio. RStudio is recommended because it is developed by the R development core team, it understands the R language and it communicates with R.<br />
We write the code in the text file (<code>.r</code> or <code>.rmd</code>) and send it to the R-console in RStudio using <code>ctrl + enter</code>.</p>
</div>
<div id="working-with-rmarkdown" class="section level3 hasAnchor" number="13.1.3">
<h3><span class="header-section-number">13.1.3</span> Working with rmarkdown<a href="refresher.html#working-with-rmarkdown" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rmarkdown allows knitting text with R code. The option to knit text with R code allows to write analyses reports without having to copy and paste results from the R console into a Word file. We can optionally show or hide R code and insert results directly in the text. Further, for sharing R code, it is extremely helpful to describe what the R code does in the text sections.</p>
<p>Text is written in plain. Latex notation can be used. Helpful <a href="https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf">introductions exist online</a>.</p>
<p>R code is written within R chunks. In the header of the R chunks we can specify how the code, results and messages are shown in the output file.
By pushing the “Knit” button all R-code is executed and displayed within a html, pdf or word document together with the text. The output format is specified in the header of the rmd-file.</p>
<p>The R-console is the calculator. R can be used as a simple calculator or we can create objects, such as <code>x</code> and apply functions such as <code>mean()</code> to the objects. Functions are followed by round brackets <code>()</code> whithin which we can provide arguments. In the help file of the functions (open by <code>?</code> followed by the name of the function), we can see what arguments a function needs and what default values the arguments have.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="refresher.html#cb12-1" tabindex="-1"></a><span class="co"># This is R-code, therefore text is outcommented by the hash-tag sign</span></span>
<span id="cb12-2"><a href="refresher.html#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="refresher.html#cb12-3" tabindex="-1"></a><span class="dv">36</span><span class="sc">/</span><span class="dv">5</span>  <span class="co"># a mathematical expression</span></span>
<span id="cb12-4"><a href="refresher.html#cb12-4" tabindex="-1"></a><span class="do">## [1] 7.2</span></span>
<span id="cb12-5"><a href="refresher.html#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="refresher.html#cb12-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">8</span>) <span class="co"># a vector, </span></span>
<span id="cb12-7"><a href="refresher.html#cb12-7" tabindex="-1"></a><span class="co"># x becomes an object in the R global environment</span></span>
<span id="cb12-8"><a href="refresher.html#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="refresher.html#cb12-9" tabindex="-1"></a><span class="fu">mean</span>(x) <span class="co"># apply a function to an object</span></span>
<span id="cb12-10"><a href="refresher.html#cb12-10" tabindex="-1"></a><span class="do">## [1] 4.666667</span></span>
<span id="cb12-11"><a href="refresher.html#cb12-11" tabindex="-1"></a></span>
<span id="cb12-12"><a href="refresher.html#cb12-12" tabindex="-1"></a><span class="co"># arguments of functions are defined with a specific order</span></span>
<span id="cb12-13"><a href="refresher.html#cb12-13" tabindex="-1"></a><span class="fu">mean</span>(<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">8</span>) <span class="co"># is not correct!</span></span>
<span id="cb12-14"><a href="refresher.html#cb12-14" tabindex="-1"></a><span class="do">## [1] 4</span></span>
<span id="cb12-15"><a href="refresher.html#cb12-15" tabindex="-1"></a><span class="co"># but</span></span>
<span id="cb12-16"><a href="refresher.html#cb12-16" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">8</span>)) <span class="co"># is correct</span></span>
<span id="cb12-17"><a href="refresher.html#cb12-17" tabindex="-1"></a><span class="do">## [1] 4.666667</span></span>
<span id="cb12-18"><a href="refresher.html#cb12-18" tabindex="-1"></a></span>
<span id="cb12-19"><a href="refresher.html#cb12-19" tabindex="-1"></a><span class="co"># check  ?mean  for arguments, order of arguments and default values</span></span></code></pre></div>
</div>
</div>
<div id="linear-regression" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Linear regression<a href="refresher.html#linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="theory" class="section level3 hasAnchor" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> Theory<a href="refresher.html#theory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You find the theory to this exercise in Chapter 11 in the online book <a href="https://tobiasroth.github.io/BDAEcology/lm.html">Bayesian Data Analyses Using Linear Models in R and Stan</a>.</p>
</div>
<div id="fitting-a-linear-regression-in-r" class="section level3 hasAnchor" number="13.2.2">
<h3><span class="header-section-number">13.2.2</span> Fitting a Linear Regression in R<a href="refresher.html#fitting-a-linear-regression-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="refresher.html#cb13-1" tabindex="-1"></a><span class="fu">library</span>(arm)</span></code></pre></div>
<pre><code>## Warning: Paket &#39;Matrix&#39; wurde unter R Version 4.2.3 erstellt</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="refresher.html#cb15-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## Warning: Paket &#39;dplyr&#39; wurde unter R Version 4.2.3 erstellt</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="refresher.html#cb17-1" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb17-2"><a href="refresher.html#cb17-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## Warning: Paket &#39;ggplot2&#39; wurde unter R Version 4.2.3 erstellt</code></pre>
</div>
<div id="data" class="section level3 hasAnchor" number="13.2.3">
<h3><span class="header-section-number">13.2.3</span> Data<a href="refresher.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We use weight data of snowfinches <em>Montifringilla nivalis</em> that have been captured and ringed during the winter months and we ask how the average weight changes with the time of the day.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="refresher.html#cb19-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/SFringlistwinter.txt&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb19-2"><a href="refresher.html#cb19-2" tabindex="-1"></a><span class="co"># select winter month</span></span>
<span id="cb19-3"><a href="refresher.html#cb19-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">is.element</span>(dat<span class="sc">$</span>month, <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>)),]</span>
<span id="cb19-4"><a href="refresher.html#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="refresher.html#cb19-5" tabindex="-1"></a>dat<span class="sc">$</span>time.num <span class="ot">&lt;-</span> dat<span class="sc">$</span>time_hour <span class="sc">+</span> dat<span class="sc">$</span>time_min<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb19-6"><a href="refresher.html#cb19-6" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>time.num, dat<span class="sc">$</span>weight, <span class="at">xlab=</span><span class="st">&quot;Hour&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Weight [g]&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">cex=</span><span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="12-RefreshingRLinMod_files/figure-html/readdat-1.png" width="672" /></p>
</div>
<div id="fit-the-regression-using-lm" class="section level3 hasAnchor" number="13.2.4">
<h3><span class="header-section-number">13.2.4</span> Fit the regression using lm<a href="refresher.html#fit-the-regression-using-lm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://tobiasroth.github.io/BDAEcology/lm.html#linear-regression">Theory</a></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="refresher.html#cb20-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight<span class="sc">~</span>time.num, <span class="at">data=</span>dat)</span>
<span id="cb20-2"><a href="refresher.html#cb20-2" tabindex="-1"></a>mod</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ time.num, data = dat)
## 
## Coefficients:
## (Intercept)     time.num  
##     41.6403       0.1263</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="refresher.html#cb22-1" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>time.num, dat<span class="sc">$</span>weight, <span class="at">xlab=</span><span class="st">&quot;Hour&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Weight [g]&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">cex=</span><span class="fl">0.7</span>)</span>
<span id="cb22-2"><a href="refresher.html#cb22-2" tabindex="-1"></a><span class="fu">abline</span>(mod, <span class="at">col=</span><span class="st">&quot;brown&quot;</span>)</span></code></pre></div>
<p><img src="12-RefreshingRLinMod_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<ul>
<li><p>What does the function <code>lm</code> do?</p></li>
<li><p>What are the model parameters and what are their estimates?</p></li>
<li><p>How does the formula of the regression line look like?</p></li>
</ul>
</div>
<div id="check-the-model-assumptions" class="section level3 hasAnchor" number="13.2.5">
<h3><span class="header-section-number">13.2.5</span> Check the model assumptions<a href="refresher.html#check-the-model-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://tobiasroth.github.io/BDAEcology/residualanalysis.html">Theory</a></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="refresher.html#cb23-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb23-2"><a href="refresher.html#cb23-2" tabindex="-1"></a><span class="fu">plot</span>(mod)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:diagnostics"></span>
<img src="12-RefreshingRLinMod_files/figure-html/diagnostics-1.png" alt="Diagnostic residual plots of a normal linear model fitted to simulated data, thus model assumptions are perfectly met. See text for explanation." width="672" />
<p class="caption">
Figure 13.1: Diagnostic residual plots of a normal linear model fitted to simulated data, thus model assumptions are perfectly met. See text for explanation.
</p>
</div>
<ul>
<li><p>Would you trust this model? Do you think the model assumptions are met?</p></li>
<li><p>Which structures of the data could violate the model assumptions?</p></li>
</ul>
</div>
<div id="drawing-conclusions" class="section level3 hasAnchor" number="13.2.6">
<h3><span class="header-section-number">13.2.6</span> Drawing Conclusions<a href="refresher.html#drawing-conclusions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To answer the question about how strongly <span class="math inline">\(y\)</span> is related to <span class="math inline">\(x\)</span> taking into account statistical uncertainty we look at the estimated slope <span class="math inline">\(\beta_{1}\)</span> and its standard error (SE). The slope <span class="math inline">\(\beta_{1}\)</span> measures how much <span class="math inline">\(y\)</span> increases in average when <span class="math inline">\(x\)</span> is increased by 1 unit. The value of <span class="math inline">\(\beta_{1}\)</span> is calculated from the data at hand. It is therefore, a characteristics of the specific data. However, we would like to draw our conclusions more generally, i.e. also in future, for new data, we expect that <span class="math inline">\(y\)</span> increases by <span class="math inline">\(\beta_{1}\)</span> if <span class="math inline">\(x\)</span> increases by 1. However for these unmeasured, future data <span class="math inline">\(\beta_{1}\)</span> may look differently. No statistical method can exactly predict how <span class="math inline">\(\beta_{1}\)</span> will look for future data. However, if we assume that the model assumptions reflect the real world reasonable well, we can use the standard error (SE) as an estimate of how far away in average the estimated <span class="math inline">\(\beta_{1}\)</span> may be from the underlying true value, i.e. a <span class="math inline">\(\beta_{1}\)</span> that we would measure if we had sampled a very high number of (i.e., all) observations.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="refresher.html#cb24-1" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ time.num, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.0561  -3.3193  -0.0361   3.0881  14.8323 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 41.64032    0.88299  47.159   &lt;2e-16 ***
## time.num     0.12631    0.07829   1.613    0.107    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.31 on 779 degrees of freedom
##   (279 Beobachtungen als fehlend gelöscht)
## Multiple R-squared:  0.003331,   Adjusted R-squared:  0.002051 
## F-statistic: 2.603 on 1 and 779 DF,  p-value: 0.1071</code></pre>
<ul>
<li>What does the output of the function <code>summary</code> tell us?</li>
</ul>
<p>To draw a 95% compatibility interval around the regression line, we ﬁrst deﬁne new x-values for which we would like to have the ﬁtted values (about 100 points across the range of x will produce smooth-looking lines when connected by line segments). We save these new x-values within the new data.frame <code>newdat</code>. (Fig. <a href="refresher.html#fig:figlmer2">13.2</a>).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="refresher.html#cb26-1" tabindex="-1"></a><span class="co"># Calculate 95% CI</span></span>
<span id="cb26-2"><a href="refresher.html#cb26-2" tabindex="-1"></a><span class="fu">range</span>(dat<span class="sc">$</span>time.num, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1]  7.833333 16.716667</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="refresher.html#cb28-1" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time.num =</span> <span class="fu">seq</span>(<span class="dv">7</span>, <span class="dv">17</span>, <span class="at">length=</span><span class="dv">100</span>))</span>
<span id="cb28-2"><a href="refresher.html#cb28-2" tabindex="-1"></a>newdat<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">newdata=</span>newdat)</span>
<span id="cb28-3"><a href="refresher.html#cb28-3" tabindex="-1"></a>newdat<span class="sc">$</span>lwr <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>, <span class="at">newdata=</span>newdat)[,<span class="dv">2</span>]</span>
<span id="cb28-4"><a href="refresher.html#cb28-4" tabindex="-1"></a>newdat<span class="sc">$</span>upr <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>, <span class="at">newdata=</span>newdat)[,<span class="dv">3</span>]</span>
<span id="cb28-5"><a href="refresher.html#cb28-5" tabindex="-1"></a></span>
<span id="cb28-6"><a href="refresher.html#cb28-6" tabindex="-1"></a></span>
<span id="cb28-7"><a href="refresher.html#cb28-7" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>time.num, dat<span class="sc">$</span>weight, <span class="at">xlab=</span><span class="st">&quot;Hour&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Weight [g]&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">cex=</span><span class="fl">0.7</span>)</span>
<span id="cb28-8"><a href="refresher.html#cb28-8" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>time.num, newdat<span class="sc">$</span>fit, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;brown&quot;</span>)</span>
<span id="cb28-9"><a href="refresher.html#cb28-9" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>time.num, newdat<span class="sc">$</span>lwr, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;brown&quot;</span>)</span>
<span id="cb28-10"><a href="refresher.html#cb28-10" tabindex="-1"></a><span class="fu">lines</span>(newdat<span class="sc">$</span>time.num, newdat<span class="sc">$</span>upr, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">&quot;brown&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:figlmer2"></span>
<img src="12-RefreshingRLinMod_files/figure-html/figlmer2-1.png" alt="Regression with 95% credible interval of the posterior distribution of the ﬁtted values." width="672" />
<p class="caption">
Figure 13.2: Regression with 95% credible interval of the posterior distribution of the ﬁtted values.
</p>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="refresher.html#cb29-1" tabindex="-1"></a><span class="co"># Make the same plot using ggplot</span></span>
<span id="cb29-2"><a href="refresher.html#cb29-2" tabindex="-1"></a><span class="co">#regplot &lt;- </span></span>
<span id="cb29-3"><a href="refresher.html#cb29-3" tabindex="-1"></a><span class="co">#  ggplot(dat, aes(x = x, y = y)) +</span></span>
<span id="cb29-4"><a href="refresher.html#cb29-4" tabindex="-1"></a><span class="co">#  geom_point() +</span></span>
<span id="cb29-5"><a href="refresher.html#cb29-5" tabindex="-1"></a><span class="co">#  geom_abline(intercept = coef(mod)[1], slope=coef(mod)[2], lwd=1, col=&quot;blue&quot;) +</span></span>
<span id="cb29-6"><a href="refresher.html#cb29-6" tabindex="-1"></a><span class="co">#  geom_line(data = newdat, aes(x = x, y = CrI_lo), lty = 3) +</span></span>
<span id="cb29-7"><a href="refresher.html#cb29-7" tabindex="-1"></a><span class="co">#  geom_line(data = newdat, aes(x = x, y = CrI_up), lty = 3) +</span></span>
<span id="cb29-8"><a href="refresher.html#cb29-8" tabindex="-1"></a><span class="co">#  labs(x = &quot;Predictor (x)&quot;, y = &quot;Outcome (y)&quot;)</span></span>
<span id="cb29-9"><a href="refresher.html#cb29-9" tabindex="-1"></a><span class="co">#regplot</span></span></code></pre></div>
<p>The uncertainty interval measures statistical uncertainty of the regression line, but it does not describe how new observations would scatter around the regression line. If we want to describe where future observations will be, we have to report the prediction interval (see online book, posterior predictive distribution), or present the data within the plot of the regression line.</p>
<ul>
<li>How would you describe the results for a paper?</li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="StudentProjects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="geolocs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MigrationCourse.pdf", "MigrationCourse.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
